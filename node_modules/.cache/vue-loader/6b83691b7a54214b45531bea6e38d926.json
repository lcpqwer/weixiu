{"remainingRequest":"/Users/szt/Desktop/iview-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/szt/Desktop/iview-admin/src/view/kaoqin/kaoqinpage.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/szt/Desktop/iview-admin/src/view/kaoqin/kaoqinpage.vue","mtime":1562652181000},{"path":"/Users/szt/Desktop/iview-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/szt/Desktop/iview-admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/szt/Desktop/iview-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/szt/Desktop/iview-admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n  data () {\n    const validatePhone = (rule, value, callback) => {\n      if (!value) {\n        return callback(new Error('手机号不能为空'));\n      } else if (!/^1[34578]\\d{9}$/.test(value)) {\n        callback('手机号格式不正确');\n      } else {\n        callback();\n      }\n    };\n    const validatePass = (rule, value, callback) => {\n      // 此时便能打印value值查看\n      console.log(value,'打印值')\n    };\n    return {\n      zoom:14,\n      center:[121.6292529148,31.2035397816],\n      ruleValidate: {\n        uid: [\n          { required: true, message: '不能为空', trigger: 'blur' }\n        ],\n        time: [\n          { required: true, message: '不能为空', trigger: 'blur' },\n          // {type: 'number',required:true,validator:validatePhone,message:'请输入正确的手机号',trigger:'change'}\n        ],\n        state: [\n          { required: true, message: '不能为空', trigger: 'blur' }\n        ],\n        img:[\n          { required: true, message: '不能为空', trigger: 'blur' }\n        ],\n        province: [\n          { required: true, message: '不能为空', trigger: 'blur' },\n        ],\n        city: [\n          { required: true, message: '不能为空', trigger: 'blur' },\n        ],\n        area: [\n          { required: true, message: '不能为空', trigger: 'blur' },\n        ],\n        address: [\n          { required: true, message: '不能为空', trigger: 'blur' },\n        ]\n      },\n      ruleValidate2: {\n        uid: [\n          { required: true, message: '不能为空', trigger: 'blur' }\n        ],\n        time: [\n          { required: true, message: '不能为空', trigger: 'blur' },\n          // {type: 'number',required:true,validator:validatePhone,message:'请输入正确的手机号',trigger:'change'}\n        ],\n        state: [\n          { required: true, message: '不能为空', trigger: 'blur' }\n        ],\n        img:[\n          { required: true, message: '不能为空', trigger: 'blur' }\n        ],\n        province: [\n          { required: true, message: '不能为空', trigger: 'blur' },\n        ],\n        city: [\n          { required: true, message: '不能为空', trigger: 'blur' },\n        ],\n        area: [\n          { required: true, message: '不能为空', trigger: 'blur' },\n        ],\n        address: [\n          { required: true, message: '不能为空', trigger: 'blur' },\n        ]\n      },\n      searchName:'',\n      searchNum:'',\n      searchPhone:'',\n      cityList:[],\n      cityList1:[],\n      cityList2:[],\n      cityListId:'',\n      cityListId1:'',\n      cityListId2:'',\n      formAdd:{\n        uid:'',\n        time:'',\n        state:'',\n        img:'',\n        province:'',\n        city:'',\n        area:'',\n        address:'',\n        longitude:'',\n        latitude:'',\n        jwt:localStorage.getItem('jwt')\n      },\n      formItem:{\n        Id:'',\n        name:'',\n        phone:'',\n        grade:'',\n        arrangement:'',\n        total:'',\n        quota:'',\n        city:'',\n        pass:'',\n        provinceid:'',\n        cityid:'',\n        areaid:'',\n        jwt:localStorage.getItem('jwt')\n      },\n      formImg:{\n        Id:\"\",\n        img:null,\n        jwt:localStorage.getItem('jwt')\n      },\n      modal1: false,\n      modal2: false,\n      modal3:false,\n      loading: true,\n      loading1: true,\n      //    分页\n      ajaxHistoryData: [],\n      // 初始化信息总条数\n      dataCount: 0,\n      // 每页显示多少条\n      pageSize: 5,\n      columns1: [\n        {\n          title: '用户姓名',\n          key: 'name',\n          width: 120\n        },\n        {\n          title: '打卡日期',\n          key: 'time'\n        },\n        {\n          title: '打卡地址',\n          key: 'address'\n        },\n        {\n          title: '自拍照',\n          key: 'img',\n          render: (h, params) => {\n            // console.log(params.row)\n            return h('img', {\n              style: {\n                width: '100px',\n                height: '100px'\n              },\n              attrs: {\n                src: params.row.img, style: 'width: 100px;height: 100px;margin: auto'\n              }\n              // on: {\n              //     click: () => {\n              //         this.hangImg(1, params.row);\n              //     }\n              // }\n            });\n          }\n        },\n        {\n          title: '考勤状态',\n          key: 'state',\n          render: (h, params) => {\n            return h('Tag', {\n              props: {\n                color: params.row.state === 1 ? 'green' : params.row.state === 2 ? 'orange':''\n              }\n            }, params.row.state === 1 ? '上班打卡' : params.row.state === 2 ? '下班打卡' :  '');\n          }\n        },\n        {\n          title: '操作',\n          key: 'action',\n          align: 'center',\n          render: (h, params) => {\n            return h('div', [\n              // h('Button', {\n              //   props: {\n              //     type: 'info',\n              //     size: 'small'\n              //   },\n              //   style: {\n              //     marginRight: '5px',\n              //     marginBottom: '5px'\n              //   },\n              //   on: {\n              //     click: () => {\n              //       this.buka(params.row);\n              //     }\n              //   }\n              // }, '补卡'),\n              h('Button', {\n                props: {\n                  type: 'info',\n                  size: 'small'\n                },\n                style: {\n                  marginRight: '5px',\n                  marginBottom: '5px'\n                },\n                on: {\n                  click: () => {\n                    this.delete(params.row);\n                  }\n                }\n              }, '删除'),\n              // h('Button', {\n              //   props: {\n              //     type: 'info',\n              //     size: 'small'\n              //   },\n              //   style: {\n              //     marginRight: '5px'\n              //   },\n              //   on: {\n              //     click: () => {\n              //       this.xiugaiimg(params.row);\n              //     }\n              //   }\n              // }, '图片修改上传'),\n            ]);\n          }\n        }\n      ],\n      data1: []\n    }\n  },\n  created() {\n    // console.log(localStorage.getItem('jwt'))\n    this.tableShow()\n  },\n  methods: {\n    //用户信息展示\n    tableShow(){\n      this.$axios({\n        method: 'post',\n        url: 'admin/attendance/show',\n        data: this.$qs.stringify({\n          uid:this.searchName,\n          jwt: localStorage.getItem('jwt')\n        })\n      }).then(res => {\n        // console.log(res.data.table,'用户信息')\n        this.ajaxHistoryData = res.data.table;\n        this.dataCount = res.data.table.length;\n        // 初始化显示，小于每页显示条数，全显，大于每页显示条数，取前每页条数显示\n        if (res.data.table.length < this.pageSize) {\n          // this.historyData = this.ajaxHistoryData;\n          this.data1 = res.data.table\n        } else {\n          this.data1 = this.ajaxHistoryData.slice(0, this.pageSize);\n        }\n      }).catch(res => {\n        this.$Message.error('请求超时,请稍后再试...');\n      });\n    },\n    //搜索\n    handSeek(){\n      this.tableShow()\n    },\n    //补卡\n    add(){\n      this.modal3=true\n      this.$axios({\n        url: 'admin/user/adress',\n        method: 'get',\n        // data: $qs.stringify({\n        //   Id: isDelete\n        // })\n      }).then(res => {\n        // console.log(res,'12345')\n        this.cityList = res.data.table\n      }).catch(res => {\n        this.$Message.error('请求超时,请稍后再试...')\n      });\n    },\n    //省联动\n    chioce(item){\n      this.cityListId=item.id\n      this.$axios({\n        method: 'post',\n        url: 'admin/user/getRegion',\n        data: this.$qs.stringify({\n          id: item.id,\n          type: item.type\n          // jwt:localStorage.getItem('jwt')\n        })\n      }).then(res => {\n        // console.log(res,'市三级联动')\n        this.cityList1=res.data\n      }).catch(res => {\n        this.$Message.error('请求超时,请稍后再试...');\n      });\n    },\n    //市联动\n    chioce1(item){\n      // console.log(JSON.stringify(item),'12345')\n      this.cityListId1=item.id\n      this.$axios({\n        method: 'post',\n        url: 'admin/user/getRegion',\n        data: this.$qs.stringify({\n          id: item.id,\n          type: item.type\n          // jwt:localStorage.getItem('jwt')\n        })\n      }).then(res => {\n        // console.log(res,'市三级联动')\n        this.cityList2=res.data\n      }).catch(res => {\n        this.$Message.error('请求超时,请稍后再试...');\n      });\n    },\n    //区联动\n    chioce2(item){\n      this.cityListId2=item.id\n    },\n    ok3 (formAdd) {\n      // console.log(this.$nextTick,'验证')\n      this.$refs[formAdd].validate((valid) => {\n        if (valid) {\n          this.$axios({\n            method: 'post',\n            url: 'admin/user/insert',\n            data: this.$qs.stringify({\n              uid:this.formItem.uid,\n              time:this.formItem.time,\n              state: this.formItem.state,\n              img: this.formItem.img,\n              province: this.cityListId,\n              city: this.cityListId1,\n              area:this.cityListId2,\n              address:this.formItem.address,\n              jwt:localStorage.getItem('jwt')\n            })\n          }).then(res => {\n            // console.log(res,'用户增加')\n            this.tableShow()\n            this.modal3 = false\n            this.formAdd = {}\n          }).catch(res => {\n            this.$Message.error('请求超时,请稍后再试...');\n          });\n          callback();\n        } else{\n          this.loading = false;\n          this.$nextTick(() => {\n            this.loading = true;\n          });\n          this.$Message.error('新增失败，请填写完整的信息!');\n        }\n      })\n      this.tableShow()\n      this.formAdd = {}\n    },\n    cancel3 () {\n      // this.$Message.info('Clicked cancel');\n    },\n    //用户修改\n    buka(row){\n      // console.log(row)\n      this.modal1=true\n      this.formItem=row\n      // this.formItem.Id=row.Id\n      // this.formItem.cityid=row.cityid\n      this.add()\n      this.chioce()\n      this.chioce1()\n      this.chioce2()\n    },\n    ok (formItem) {\n      // console.log(this.$refs[formItem])\n      this.modal3=false\n      this.$refs[formItem].validate((valid) => {\n        if (valid) {\n          this.$axios({\n            method: 'post',\n            url: 'admin/user/upd',\n            data: this.$qs.stringify({\n              uid:this.formItem.uid,\n              time:this.formItem.time,\n              state: this.formItem.state,\n              img: this.formItem.img,\n              province: this.cityListId,\n              city: this.cityListId1,\n              area:this.cityListId2,\n              address:this.formItem.address,\n              jwt:localStorage.getItem('jwt')\n            })\n          }).then(res => {\n            // console.log(res,'用户修改')\n            this.modal3=false\n            this.modal1=false\n            this.tableShow()\n          }).catch(res => {\n            this.$Message.error('请求超时,请稍后再试...');\n          });\n          callback();\n        } else{\n          this.loading = false;\n          this.$nextTick(() => {\n            this.loading = true;\n          });\n          this.$Message.error('修改失败,请正确填写信息!');\n        }\n      })\n      this.tableShow()\n    },\n    cancel () {\n      this.modal3=false\n      // this.$Message.info('Clicked cancel');\n    },\n    // 修改上传图片\n    xiugaiimg(row){\n      // console.log(row)\n      this.modal2=true\n      // this.formImg=row\n      this.formImg.Id=row.Id\n    },\n    handleUpload (file) {\n      this.formImg.img = file;\n    },\n    handleSuccess (response, file, fileList) {\n      if(response.code === 200){\n        this.modal2=false\n        this.tableShow()\n      }\n    },\n    //删除\n    delete(row){\n      // console.log(row)\n      this.$Modal.confirm({\n        title: '删除',\n        content: '确认删除该条信息吗？',\n        onOk: () => {\n          this.$axios({\n            method: 'post',\n            url: 'admin/attendance/delete',\n            data: this.$qs.stringify({\n              Id: row.Id,\n              jwt:localStorage.getItem('jwt')\n            })\n          }).then(res => {\n            this.tableShow()\n          }).catch(res => {\n            this.$Message.error('请求超时,请稍后再试...');\n          });\n        },\n        onCancel: () => {\n          this.$Message.info('取消');\n        }\n      });\n    },\n    //分页\n    changepage (index) {\n      var _start = (index - 1) * this.pageSize;\n      var _end = index * this.pageSize;\n      this.data1 = this.ajaxHistoryData.slice(_start, _end);\n    }\n  }\n}\n",{"version":3,"sources":["kaoqinpage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"kaoqinpage.vue","sourceRoot":"src/view/kaoqin","sourcesContent":["<template>\n  <div>\n    <!--<Button style=\"margin-left: 10px;margin-right: 5px\" type=\"info\" @click=\"add\">补卡</Button>-->\n    <!--搜索-->\n    <!--<Input clearable placeholder=\"请输入用户名关键字搜索\" class=\"search-input\" v-model=\"searchName\" style=\"width: 200px\"/>-->\n    <!--<Input clearable placeholder=\"请输入工号关键字搜索\" class=\"search-input\" v-model=\"searchNum\" style=\"width: 200px\"/>-->\n    <!--<Input clearable placeholder=\"请输入手机号关键字搜索\" class=\"search-input\" v-model=\"searchPhone\" style=\"width: 200px\"/>-->\n    <!--<Button type=\"info\" @click=\"handSeek\">搜索</Button>-->\n    <Table :columns=\"columns1\" :data=\"data1\"></Table>\n    <!--新增-->\n    <!--<Modal-->\n      <!--width=\"700\"-->\n      <!--v-model=\"modal3\"-->\n      <!--title=\"用户补卡信息\"-->\n      <!--@on-ok=\"ok3('formAdd')\"-->\n      <!--@on-cancel=\"cancel3\"-->\n      <!--:loading=\"loading\">-->\n      <!--<Form :model=\"formAdd\" :label-width=\"80\" :rules=\"ruleValidate\" ref=\"formAdd\">-->\n        <!--<FormItem label=\"姓名\" prop=\"uid\">-->\n          <!--<Input v-model=\"formAdd.uid\" placeholder=\"\" :maxlength='16'></Input>-->\n        <!--</FormItem>-->\n        <!--<FormItem label=\"补卡时间\" prop=\"time\">-->\n          <!--<Input v-model=\"formAdd.time\" placeholder=\"\" number></Input>-->\n        <!--</FormItem>-->\n        <!--<FormItem label=\"考勤\" prop=\"state\">-->\n          <!--<Input v-model=\"formAdd.state\" placeholder=\"\"></Input>-->\n        <!--</FormItem>-->\n        <!--<FormItem label=\"自拍照\" prop=\"img\">-->\n          <!--<div class=\"tupian\">-->\n            <!--<img v-model=\"formAdd.img\" placeholder=\"\"></img>-->\n          <!--</div>-->\n        <!--</FormItem>-->\n        <!--<FormItem label=\"省份\" prop=\"province\">-->\n          <!--<Select v-model=\"formAdd.province\" style=\"width:200px\">-->\n            <!--<Option v-for=\"item in cityList\" :value=\"item.name\" :key=\"item.id\" @click.native=\"chioce(item)\">{{ item.name }}</Option>-->\n          <!--</Select>-->\n        <!--</FormItem>-->\n        <!--<FormItem label=\"城市\" prop=\"city\">-->\n          <!--<Select v-model=\"formAdd.city\" style=\"width:200px\">-->\n            <!--<Option v-for=\"item in cityList1\" :value=\"item.name\" :key=\"item.id\" @click.native=\"chioce1(item)\">{{ item.name }}</Option>-->\n          <!--</Select>-->\n        <!--</FormItem>-->\n        <!--<FormItem label=\"地区\" prop=\"area\">-->\n          <!--<Select v-model=\"formAdd.area\" style=\"width:200px\">-->\n            <!--<Option v-for=\"item in cityList2\" :value=\"item.name\" :key=\"item.id\" @click.native=\"chioce2(item)\">{{ item.name }}</Option>-->\n          <!--</Select>-->\n        <!--</FormItem>-->\n        <!--<FormItem label=\"详细地址\" prop=\"address\">-->\n          <!--<Input v-model=\"formAdd.address\" placeholder=\"请选择您的详细地址\"></Input>-->\n          <!--<div class=\"map\">-->\n            <!--<el-amap vid=\"amapDemo\" class=\"amap\" :center=\"center\" :zoom=\"zoom\">-->\n              <!--<el-amap-marker :position=\"center\" vid=\"amapMarker\"></el-amap-marker>-->\n            <!--</el-amap>-->\n          <!--</div>-->\n        <!--</FormItem>-->\n        <!--&lt;!&ndash;<FormItem label=\"经度\" prop=\"longitude\">&ndash;&gt;-->\n          <!--&lt;!&ndash;<Input v-model=\"formAdd.longitude\" placeholder=\"\"></Input>&ndash;&gt;-->\n        <!--&lt;!&ndash;</FormItem>&ndash;&gt;-->\n        <!--&lt;!&ndash;<FormItem label=\"纬度\" prop=\"latitude\">&ndash;&gt;-->\n          <!--&lt;!&ndash;<Input v-model=\"formAdd.latitude\" placeholder=\"\"></Input>&ndash;&gt;-->\n        <!--&lt;!&ndash;</FormItem>&ndash;&gt;-->\n      <!--</Form>-->\n    <!--</Modal>-->\n    <!--//修改弹框-->\n    <!--<Button type=\"primary\" @click=\"modal1 = true\">修改</Button>-->\n    <!--<Modal-->\n      <!--v-model=\"modal1\"-->\n      <!--title=\"补卡信息\"-->\n      <!--@on-ok=\"ok('formItem')\"-->\n      <!--@on-cancel=\"cancel\"-->\n      <!--:loading=\"loading1\">-->\n      <!--<Form :model=\"formItem\" :label-width=\"80\" :rules=\"ruleValidate2\" ref=\"formItem\">-->\n        <!--<FormItem label=\"姓名\" prop=\"uid\">-->\n          <!--<Input v-model=\"formItem.uid\" placeholder=\"\" :maxlength='16'></Input>-->\n        <!--</FormItem>-->\n        <!--<FormItem label=\"补卡时间\" prop=\"time\">-->\n          <!--<Input v-model=\"formItem.time\" placeholder=\"\" number></Input>-->\n        <!--</FormItem>-->\n        <!--<FormItem label=\"考勤\" prop=\"state\">-->\n          <!--<Input v-model=\"formItem.state\" placeholder=\"\"></Input>-->\n        <!--</FormItem>-->\n        <!--<FormItem label=\"自拍照\" prop=\"img\">-->\n          <!--<img v-model=\"formItem.img\" placeholder=\"\"></img>-->\n        <!--</FormItem>-->\n        <!--<FormItem label=\"省份\" prop=\"province\">-->\n          <!--<Select v-model=\"formItem.province\" style=\"width:200px\">-->\n            <!--<Option v-for=\"item in cityList\" :value=\"item.name\" :key=\"item.id\" @click.native=\"chioce(item)\">{{ item.name }}</Option>-->\n          <!--</Select>-->\n        <!--</FormItem>-->\n        <!--<FormItem label=\"城市\" prop=\"city\">-->\n          <!--<Select v-model=\"formItem.city\" style=\"width:200px\">-->\n            <!--<Option v-for=\"item in cityList1\" :value=\"item.name\" :key=\"item.id\" @click.native=\"chioce1(item)\">{{ item.name }}</Option>-->\n          <!--</Select>-->\n        <!--</FormItem>-->\n        <!--<FormItem label=\"地区\" prop=\"area\">-->\n          <!--<Select v-model=\"formItem.area\" style=\"width:200px\">-->\n            <!--<Option v-for=\"item in cityList2\" :value=\"item.name\" :key=\"item.id\" @click.native=\"chioce2(item)\">{{ item.name }}</Option>-->\n          <!--</Select>-->\n        <!--</FormItem>-->\n        <!--<FormItem label=\"详细地址\" prop=\"address\">-->\n          <!--<Input v-model=\"formItem.address\" placeholder=\"\"></Input>-->\n        <!--</FormItem>-->\n        <!--<FormItem label=\"经度\" prop=\"longitude\">-->\n          <!--<Input v-model=\"formItem.longitude\" placeholder=\"\"></Input>-->\n        <!--</FormItem>-->\n        <!--<FormItem label=\"纬度\" prop=\"latitude\">-->\n          <!--<Input v-model=\"formItem.latitude\" placeholder=\"\"></Input>-->\n        <!--</FormItem>-->\n      <!--</Form>-->\n    <!--</Modal>-->\n    <!--//修改图片-->\n    <!--<Modal-->\n      <!--v-model=\"modal2\"-->\n      <!--title=\"修改用户图片\">-->\n      <!--<Form :model=\"formImg\" :label-width=\"80\">-->\n        <!--<FormItem label=\"图片文件\">-->\n          <!--<Upload-->\n            <!--ref=\"upload\"-->\n            <!--action=\"http://192.168.8.100/repair/public/admin/user/upd_imgs\"-->\n            <!--:data=\"formImg\"-->\n            <!--:show-upload-list=\"false\"-->\n            <!--:format=\"['jpg','jpeg','png']\"-->\n            <!--:before-upload=\"handleUpload\"-->\n            <!--:on-success=\"handleSuccess\">-->\n            <!--<Button icon=\"ios-cloud-upload-outline\" type=\"info\" style=\"margin-bottom: 10px\">点击上传封图</Button>-->\n          <!--</Upload>-->\n          <!--<img :src=\"formImg.img\" alt=\"\" style=\"width: 200px\">-->\n        <!--</FormItem>-->\n      <!--</Form>-->\n      <!--&lt;!&ndash;隐藏Modal对话框确定取消按钮&ndash;&gt;-->\n      <!--<div slot=\"footer\"></div>-->\n    <!--</Modal>-->\n    <!--//分页-->\n    <div style=\"text-align: right\">\n      <Page :total=\"dataCount\" :page-size=\"pageSize\" show-total class=\"paging\" @on-change=\"changepage\"></Page>\n    </div>\n  </div>\n</template>\n\n<script>\n  export default {\n    data () {\n      const validatePhone = (rule, value, callback) => {\n        if (!value) {\n          return callback(new Error('手机号不能为空'));\n        } else if (!/^1[34578]\\d{9}$/.test(value)) {\n          callback('手机号格式不正确');\n        } else {\n          callback();\n        }\n      };\n      const validatePass = (rule, value, callback) => {\n        // 此时便能打印value值查看\n        console.log(value,'打印值')\n      };\n      return {\n        zoom:14,\n        center:[121.6292529148,31.2035397816],\n        ruleValidate: {\n          uid: [\n            { required: true, message: '不能为空', trigger: 'blur' }\n          ],\n          time: [\n            { required: true, message: '不能为空', trigger: 'blur' },\n            // {type: 'number',required:true,validator:validatePhone,message:'请输入正确的手机号',trigger:'change'}\n          ],\n          state: [\n            { required: true, message: '不能为空', trigger: 'blur' }\n          ],\n          img:[\n            { required: true, message: '不能为空', trigger: 'blur' }\n          ],\n          province: [\n            { required: true, message: '不能为空', trigger: 'blur' },\n          ],\n          city: [\n            { required: true, message: '不能为空', trigger: 'blur' },\n          ],\n          area: [\n            { required: true, message: '不能为空', trigger: 'blur' },\n          ],\n          address: [\n            { required: true, message: '不能为空', trigger: 'blur' },\n          ]\n        },\n        ruleValidate2: {\n          uid: [\n            { required: true, message: '不能为空', trigger: 'blur' }\n          ],\n          time: [\n            { required: true, message: '不能为空', trigger: 'blur' },\n            // {type: 'number',required:true,validator:validatePhone,message:'请输入正确的手机号',trigger:'change'}\n          ],\n          state: [\n            { required: true, message: '不能为空', trigger: 'blur' }\n          ],\n          img:[\n            { required: true, message: '不能为空', trigger: 'blur' }\n          ],\n          province: [\n            { required: true, message: '不能为空', trigger: 'blur' },\n          ],\n          city: [\n            { required: true, message: '不能为空', trigger: 'blur' },\n          ],\n          area: [\n            { required: true, message: '不能为空', trigger: 'blur' },\n          ],\n          address: [\n            { required: true, message: '不能为空', trigger: 'blur' },\n          ]\n        },\n        searchName:'',\n        searchNum:'',\n        searchPhone:'',\n        cityList:[],\n        cityList1:[],\n        cityList2:[],\n        cityListId:'',\n        cityListId1:'',\n        cityListId2:'',\n        formAdd:{\n          uid:'',\n          time:'',\n          state:'',\n          img:'',\n          province:'',\n          city:'',\n          area:'',\n          address:'',\n          longitude:'',\n          latitude:'',\n          jwt:localStorage.getItem('jwt')\n        },\n        formItem:{\n          Id:'',\n          name:'',\n          phone:'',\n          grade:'',\n          arrangement:'',\n          total:'',\n          quota:'',\n          city:'',\n          pass:'',\n          provinceid:'',\n          cityid:'',\n          areaid:'',\n          jwt:localStorage.getItem('jwt')\n        },\n        formImg:{\n          Id:\"\",\n          img:null,\n          jwt:localStorage.getItem('jwt')\n        },\n        modal1: false,\n        modal2: false,\n        modal3:false,\n        loading: true,\n        loading1: true,\n        //    分页\n        ajaxHistoryData: [],\n        // 初始化信息总条数\n        dataCount: 0,\n        // 每页显示多少条\n        pageSize: 5,\n        columns1: [\n          {\n            title: '用户姓名',\n            key: 'name',\n            width: 120\n          },\n          {\n            title: '打卡日期',\n            key: 'time'\n          },\n          {\n            title: '打卡地址',\n            key: 'address'\n          },\n          {\n            title: '自拍照',\n            key: 'img',\n            render: (h, params) => {\n              // console.log(params.row)\n              return h('img', {\n                style: {\n                  width: '100px',\n                  height: '100px'\n                },\n                attrs: {\n                  src: params.row.img, style: 'width: 100px;height: 100px;margin: auto'\n                }\n                // on: {\n                //     click: () => {\n                //         this.hangImg(1, params.row);\n                //     }\n                // }\n              });\n            }\n          },\n          {\n            title: '考勤状态',\n            key: 'state',\n            render: (h, params) => {\n              return h('Tag', {\n                props: {\n                  color: params.row.state === 1 ? 'green' : params.row.state === 2 ? 'orange':''\n                }\n              }, params.row.state === 1 ? '上班打卡' : params.row.state === 2 ? '下班打卡' :  '');\n            }\n          },\n          {\n            title: '操作',\n            key: 'action',\n            align: 'center',\n            render: (h, params) => {\n              return h('div', [\n                // h('Button', {\n                //   props: {\n                //     type: 'info',\n                //     size: 'small'\n                //   },\n                //   style: {\n                //     marginRight: '5px',\n                //     marginBottom: '5px'\n                //   },\n                //   on: {\n                //     click: () => {\n                //       this.buka(params.row);\n                //     }\n                //   }\n                // }, '补卡'),\n                h('Button', {\n                  props: {\n                    type: 'info',\n                    size: 'small'\n                  },\n                  style: {\n                    marginRight: '5px',\n                    marginBottom: '5px'\n                  },\n                  on: {\n                    click: () => {\n                      this.delete(params.row);\n                    }\n                  }\n                }, '删除'),\n                // h('Button', {\n                //   props: {\n                //     type: 'info',\n                //     size: 'small'\n                //   },\n                //   style: {\n                //     marginRight: '5px'\n                //   },\n                //   on: {\n                //     click: () => {\n                //       this.xiugaiimg(params.row);\n                //     }\n                //   }\n                // }, '图片修改上传'),\n              ]);\n            }\n          }\n        ],\n        data1: []\n      }\n    },\n    created() {\n      // console.log(localStorage.getItem('jwt'))\n      this.tableShow()\n    },\n    methods: {\n      //用户信息展示\n      tableShow(){\n        this.$axios({\n          method: 'post',\n          url: 'admin/attendance/show',\n          data: this.$qs.stringify({\n            uid:this.searchName,\n            jwt: localStorage.getItem('jwt')\n          })\n        }).then(res => {\n          // console.log(res.data.table,'用户信息')\n          this.ajaxHistoryData = res.data.table;\n          this.dataCount = res.data.table.length;\n          // 初始化显示，小于每页显示条数，全显，大于每页显示条数，取前每页条数显示\n          if (res.data.table.length < this.pageSize) {\n            // this.historyData = this.ajaxHistoryData;\n            this.data1 = res.data.table\n          } else {\n            this.data1 = this.ajaxHistoryData.slice(0, this.pageSize);\n          }\n        }).catch(res => {\n          this.$Message.error('请求超时,请稍后再试...');\n        });\n      },\n      //搜索\n      handSeek(){\n        this.tableShow()\n      },\n      //补卡\n      add(){\n        this.modal3=true\n        this.$axios({\n          url: 'admin/user/adress',\n          method: 'get',\n          // data: $qs.stringify({\n          //   Id: isDelete\n          // })\n        }).then(res => {\n          // console.log(res,'12345')\n          this.cityList = res.data.table\n        }).catch(res => {\n          this.$Message.error('请求超时,请稍后再试...')\n        });\n      },\n      //省联动\n      chioce(item){\n        this.cityListId=item.id\n        this.$axios({\n          method: 'post',\n          url: 'admin/user/getRegion',\n          data: this.$qs.stringify({\n            id: item.id,\n            type: item.type\n            // jwt:localStorage.getItem('jwt')\n          })\n        }).then(res => {\n          // console.log(res,'市三级联动')\n          this.cityList1=res.data\n        }).catch(res => {\n          this.$Message.error('请求超时,请稍后再试...');\n        });\n      },\n      //市联动\n      chioce1(item){\n        // console.log(JSON.stringify(item),'12345')\n        this.cityListId1=item.id\n        this.$axios({\n          method: 'post',\n          url: 'admin/user/getRegion',\n          data: this.$qs.stringify({\n            id: item.id,\n            type: item.type\n            // jwt:localStorage.getItem('jwt')\n          })\n        }).then(res => {\n          // console.log(res,'市三级联动')\n          this.cityList2=res.data\n        }).catch(res => {\n          this.$Message.error('请求超时,请稍后再试...');\n        });\n      },\n      //区联动\n      chioce2(item){\n        this.cityListId2=item.id\n      },\n      ok3 (formAdd) {\n        // console.log(this.$nextTick,'验证')\n        this.$refs[formAdd].validate((valid) => {\n          if (valid) {\n            this.$axios({\n              method: 'post',\n              url: 'admin/user/insert',\n              data: this.$qs.stringify({\n                uid:this.formItem.uid,\n                time:this.formItem.time,\n                state: this.formItem.state,\n                img: this.formItem.img,\n                province: this.cityListId,\n                city: this.cityListId1,\n                area:this.cityListId2,\n                address:this.formItem.address,\n                jwt:localStorage.getItem('jwt')\n              })\n            }).then(res => {\n              // console.log(res,'用户增加')\n              this.tableShow()\n              this.modal3 = false\n              this.formAdd = {}\n            }).catch(res => {\n              this.$Message.error('请求超时,请稍后再试...');\n            });\n            callback();\n          } else{\n            this.loading = false;\n            this.$nextTick(() => {\n              this.loading = true;\n            });\n            this.$Message.error('新增失败，请填写完整的信息!');\n          }\n        })\n        this.tableShow()\n        this.formAdd = {}\n      },\n      cancel3 () {\n        // this.$Message.info('Clicked cancel');\n      },\n      //用户修改\n      buka(row){\n        // console.log(row)\n        this.modal1=true\n        this.formItem=row\n        // this.formItem.Id=row.Id\n        // this.formItem.cityid=row.cityid\n        this.add()\n        this.chioce()\n        this.chioce1()\n        this.chioce2()\n      },\n      ok (formItem) {\n        // console.log(this.$refs[formItem])\n        this.modal3=false\n        this.$refs[formItem].validate((valid) => {\n          if (valid) {\n            this.$axios({\n              method: 'post',\n              url: 'admin/user/upd',\n              data: this.$qs.stringify({\n                uid:this.formItem.uid,\n                time:this.formItem.time,\n                state: this.formItem.state,\n                img: this.formItem.img,\n                province: this.cityListId,\n                city: this.cityListId1,\n                area:this.cityListId2,\n                address:this.formItem.address,\n                jwt:localStorage.getItem('jwt')\n              })\n            }).then(res => {\n              // console.log(res,'用户修改')\n              this.modal3=false\n              this.modal1=false\n              this.tableShow()\n            }).catch(res => {\n              this.$Message.error('请求超时,请稍后再试...');\n            });\n            callback();\n          } else{\n            this.loading = false;\n            this.$nextTick(() => {\n              this.loading = true;\n            });\n            this.$Message.error('修改失败,请正确填写信息!');\n          }\n        })\n        this.tableShow()\n      },\n      cancel () {\n        this.modal3=false\n        // this.$Message.info('Clicked cancel');\n      },\n      // 修改上传图片\n      xiugaiimg(row){\n        // console.log(row)\n        this.modal2=true\n        // this.formImg=row\n        this.formImg.Id=row.Id\n      },\n      handleUpload (file) {\n        this.formImg.img = file;\n      },\n      handleSuccess (response, file, fileList) {\n        if(response.code === 200){\n          this.modal2=false\n          this.tableShow()\n        }\n      },\n      //删除\n      delete(row){\n        // console.log(row)\n        this.$Modal.confirm({\n          title: '删除',\n          content: '确认删除该条信息吗？',\n          onOk: () => {\n            this.$axios({\n              method: 'post',\n              url: 'admin/attendance/delete',\n              data: this.$qs.stringify({\n                Id: row.Id,\n                jwt:localStorage.getItem('jwt')\n              })\n            }).then(res => {\n              this.tableShow()\n            }).catch(res => {\n              this.$Message.error('请求超时,请稍后再试...');\n            });\n          },\n          onCancel: () => {\n            this.$Message.info('取消');\n          }\n        });\n      },\n      //分页\n      changepage (index) {\n        var _start = (index - 1) * this.pageSize;\n        var _end = index * this.pageSize;\n        this.data1 = this.ajaxHistoryData.slice(_start, _end);\n      }\n    }\n  }\n</script>\n\n<style scoped>\n  .tupian{\n    width: 100px;\n  }\n  .map {\n    width: 100%;\n    height: 400px;\n  }\n\n</style>\n"]}]}